{"version":3,"file":"static/js/7.00c75b3b.chunk.js","mappings":"2WAQqBA,EAAAA,SAAAA,IAAAA,EAAAA,EAAAA,GAAAA,EAAAA,GAAAA,IAAAA,GAAAA,EAAAA,EAAAA,GAAAA,GAAAA,SAAAA,IAAAA,IAAAA,GAAAA,EAAAA,EAAAA,GAAAA,KAAAA,GAAAA,IAAAA,IAAAA,EAAAA,UAAAA,OAAAA,EAAAA,IAAAA,MAAAA,GAAAA,EAAAA,EAAAA,EAAAA,EAAAA,IAAAA,EAAAA,GAAAA,UAAAA,GAQV,OARUA,EAAAA,EAAAA,KAAAA,MAAAA,EAAAA,CAAAA,MAAAA,OAAAA,KACpBC,OAAS,IAAIC,EAAAA,EAAJ,EACTC,WAAYC,EAAAA,EAAAA,aAAY,EACxBC,MAAQ,CACPC,WAAOC,EACPC,oBAAgBD,GAFT,EAIRE,KAAO,gBAAgB,EACvBC,QAAU,IAAIC,IAAJ,EAgHT,OAhHS,mCACV,SAAYC,GACX,GAAIC,KAAKH,QAAQI,IAAIF,GACpB,OAAOG,QAAQC,UAGhB,IAAMC,EAASC,SAASC,cAAc,UACtCF,EAAOL,IAAMA,EACbK,EAAOG,OAAQ,EAEf,IAAMC,EAAU,IAAIN,SAAQ,SAACC,EAASM,GACrCL,EAAOM,iBAAiB,QAAQ,WAC/BP,OAGDC,EAAOM,iBAAiB,SAAS,WAChCD,UAQF,OAJAJ,SAASM,KAAKC,OAAOR,GAErBJ,KAAKH,QAAQgB,IAAId,EAAKK,GAEfI,IACP,uBACD,WACC,GAAiC,KAA7BR,KAAKc,MAAMC,SAASC,KACvB,MAAM,IAAIC,MAAM,wBAGjB,OAAO,IAAIC,IAAIlB,KAAKc,MAAMC,SAASC,KAAKG,MAAM,MAC9C,sBACD,SAASC,GACRC,EAAAA,EAAON,SAASO,OAAOF,KACvB,mEACD,oKADC,IACD,kEACA,uGAEQpB,KAAKuB,qBAFb,sDAIEC,QAAQ/B,MAAR,MACAO,KAAKyB,SAAS,CACbhC,MAAO,KAAMiC,QANhB,0GADA,IACA,qEAUA,oGAC2B1B,KAAKH,SADhC,IACC,2BAAyC,GAAD,kBAA9BE,EAA8B,UAChC4B,SACP3B,KAAKH,QAAQ+B,OAAO7B,GAHtB,gIAVA,IAUA,+DAMA,WAAqB8B,GAArB,iEAEC7B,KAAKyB,SAAS,CACb9B,eAAgBkC,IAHlB,mGANA,IAMA,oBAMA,WAIE,IAAIC,EADL,OAFAC,EAAAA,EAAAA,IAAS,eAEgBrC,IAArBM,KAAKR,MAAMC,OAIbqC,OADiCpC,IAA9BM,KAAKR,MAAMG,gBACA,yBAAMK,KAAKR,MAAMC,SAEjB,yBAAMO,KAAKR,MAAMG,kBAI/B,kBAAMqC,IAAKhC,KAAKV,UAAhB,WACC,8DAC+B,SAAC,KAAD,UAAaU,KAAKJ,OADjD,KAEC,kBACCkC,MAEF,iDACuB,KACtB,cACCG,KAAK,KACLC,QAAS,SAAAC,GACRA,EAAMC,iBACNf,EAAAA,EAAON,SAASsB,UAJlB,kBAFD,KAYC,kBAZD,0CAayC,KACxC,SAAC,KAAD,CAAMC,IAAIC,EAAAA,EAAAA,GAAa,IAAK,OAAQC,OAAO,UAA3C,iBAEQ,IAhBT,KAiBI,KACH,SAAC,KAAD,CAAMF,IAAIC,EAAAA,EAAAA,GAAa,IAAK,WAAYC,OAAO,UAA/C,wBAlBD,YA4BF,iBAAMR,IAAKhC,KAAKV,UAAhB,UACC,0BACC,SAAC,KAAD,UAAaU,KAAKJ,OADnB,0BAKF,EAxHmBT,CAAqBsD,EAAAA,WA2HnC,SAASC,EAAWC,GAC1B,OAAOC,EAAAA,EAAAA,aAAW,SAAC9B,EAAOkB,GACzB,OAAO,SAACW,GAAD,kBAAa7B,GAAb,IAAoBkB,IAAKA,EAAKjB,UAAU8B,EAAAA,EAAAA,c,uHC3G3CC,EAAAA,SAAAA,IAAAA,EAAAA,EAAAA,GAAAA,EAAAA,GAAAA,IAAAA,GAAAA,EAAAA,EAAAA,GAAAA,GAAAA,SAAAA,IAAAA,IAAAA,GAAAA,EAAAA,EAAAA,GAAAA,KAAAA,GAAAA,IAAAA,IAAAA,EAAAA,UAAAA,OAAAA,EAAAA,IAAAA,MAAAA,GAAAA,EAAAA,EAAAA,EAAAA,EAAAA,IAAAA,EAAAA,GAAAA,UAAAA,GACgB,OADhBA,EAAAA,EAAAA,KAAAA,MAAAA,EAAAA,CAAAA,MAAAA,OAAAA,KACLlD,KAAO,gBACP,OADO,6EACP,sGACOI,KAAKL,eAAe,2CAD3B,uBAEOK,KAAK+C,YAAY,oBAFxB,uBAGO/C,KAAKL,eAAe,2CAH3B,uBAIOK,KAAK+C,YAAY,oBAJxB,wBAKO/C,KAAKL,iBALZ,eAUOqD,EAAS3B,EAAAA,EAAO4B,YAGtBjD,KAAKL,eAAe,uDAbrB,UAcOuD,UAAUC,cAAcC,SAAS,YAAa,CACnDC,MAAOL,EAAOM,OAGdC,eAAgB,SAlBlB,yBAoBOvD,KAAKL,iBApBZ,yBAsBOK,KAAKL,eAAe,+BAtB3B,yBAwBqB6D,MAAMC,EAAAA,IAxB3B,YAwBQC,EAxBR,QAyBYC,GAzBZ,kCA0BeD,EAAKE,OA1BpB,8CA6BO5D,KAAKL,iBA7BZ,QA+BCK,KAAK6D,SACJ,IAAI3C,IACH8B,EAAOc,UAAU9D,KAAK+D,aACtB,IAAI7C,IAAI8B,EAAOM,OAAQjC,EAAAA,EAAON,YAlCjC,mGADO,MACP,EAFK+B,CAAoB3D,EAAAA,GA0C1B,WAAeuD,EAAAA,EAAAA,GAAWI","sources":["CompatModule.js","pages/compat/Ultraviolet.js"],"sourcesContent":["import { Component, createRef, forwardRef } from 'react';\nimport { Link, useLocation } from 'react-router-dom';\nimport Layout from './Layout.js';\nimport { Obfuscated } from './obfuscate.js';\nimport { set_page } from './root.js';\nimport { resolveRoute } from './Routes.js';\nimport './styles/Compat.scss';\n\nexport default class CompatModule extends Component {\n\tlayout = new Layout();\n\tcontainer = createRef();\n\tstate = {\n\t\terror: undefined,\n\t\tpossible_error: undefined,\n\t};\n\tname = 'Generic Proxy';\n\tscripts = new Map();\n\tload_script(src) {\n\t\tif (this.scripts.has(src)) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst script = document.createElement('script');\n\t\tscript.src = src;\n\t\tscript.async = true;\n\n\t\tconst promise = new Promise((resolve, reject) => {\n\t\t\tscript.addEventListener('load', () => {\n\t\t\t\tresolve();\n\t\t\t});\n\n\t\t\tscript.addEventListener('error', () => {\n\t\t\t\treject();\n\t\t\t});\n\t\t});\n\n\t\tdocument.body.append(script);\n\n\t\tthis.scripts.set(src, script);\n\n\t\treturn promise;\n\t}\n\tget destination() {\n\t\tif (this.props.location.hash === '') {\n\t\t\tthrow new Error('No hash was provided');\n\t\t}\n\n\t\treturn new URL(this.props.location.hash.slice(1));\n\t}\n\tredirect(url) {\n\t\tglobal.location.assign(url);\n\t}\n\tasync _componentDidMount() {}\n\tasync componentDidMount() {\n\t\ttry {\n\t\t\tawait this._componentDidMount();\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t\tthis.setState({\n\t\t\t\terror: error.stack,\n\t\t\t});\n\t\t}\n\t}\n\tasync componentWillUnmount() {\n\t\tfor (let [src, script] of this.scripts) {\n\t\t\tscript.remove();\n\t\t\tthis.scripts.delete(src);\n\t\t}\n\t}\n\tasync possible_error(message) {\n\t\t// errors must be VERY verbose for the user\n\t\tthis.setState({\n\t\t\tpossible_error: message,\n\t\t});\n\t}\n\trender() {\n\t\tset_page('compat');\n\n\t\tif (this.state.error !== undefined) {\n\t\t\tlet description;\n\n\t\t\tif (this.state.possible_error === undefined) {\n\t\t\t\tdescription = <pre>{this.state.error}</pre>;\n\t\t\t} else {\n\t\t\t\tdescription = <pre>{this.state.possible_error}</pre>;\n\t\t\t}\n\n\t\t\treturn (\n\t\t\t\t<main ref={this.container}>\n\t\t\t\t\t<span>\n\t\t\t\t\t\tAn error occured when loading <Obfuscated>{this.name}</Obfuscated>:\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t{description}\n\t\t\t\t\t</span>\n\t\t\t\t\t<p>\n\t\t\t\t\t\tTry again by clicking{' '}\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\thref=\"i:\"\n\t\t\t\t\t\t\tonClick={event => {\n\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t\tglobal.location.reload();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\there\n\t\t\t\t\t\t</a>\n\t\t\t\t\t\t.\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\tIf this problem still occurs, check our{' '}\n\t\t\t\t\t\t<Link to={resolveRoute('/', 'faq')} target=\"_parent\">\n\t\t\t\t\t\t\tFAQ\n\t\t\t\t\t\t</Link>{' '}\n\t\t\t\t\t\tor{' '}\n\t\t\t\t\t\t<Link to={resolveRoute('/', 'contact')} target=\"_parent\">\n\t\t\t\t\t\t\tContact Us\n\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t.\n\t\t\t\t\t</p>\n\t\t\t\t</main>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<main ref={this.container}>\n\t\t\t\t<p>\n\t\t\t\t\t<Obfuscated>{this.name}</Obfuscated> is loading...\n\t\t\t\t</p>\n\t\t\t</main>\n\t\t);\n\t}\n}\n\nexport function wrapCompat(Element) {\n\treturn forwardRef((props, ref) => {\n\t\treturn <Element {...props} ref={ref} location={useLocation()} />;\n\t});\n}\n","import CompatModule, { wrapCompat } from '../../CompatModule.js';\nimport { BARE_API } from '../../root.js';\n\n/**\n * @callback UVEncode\n * @argument {string} decoded\n * @returns {string} encoded\n */\n\n/**\n * @callback UVDecode\n * @argument {string} encoded\n * @returns {string} decoded\n */\n\n/**\n * @typedef {object} UVConfig\n * @property {string} bare\n * @property {string} handler\n * @property {string} bundle\n * @property {string} config\n * @property {string} sw\n * @property {UVEncode} encodeUrl\n * @property {UVDecode} decodeUrl\n */\n\nclass Ultraviolet extends CompatModule {\n\tname = 'Ultraviolet';\n\tasync _componentDidMount() {\n\t\tawait this.possible_error('Failure loading the Ultraviolet bundle.');\n\t\tawait this.load_script('/uv/uv.bundle.js');\n\t\tawait this.possible_error('Failure loading the Ultraviolet config.');\n\t\tawait this.load_script('/uv/uv.config.js');\n\t\tawait this.possible_error();\n\n\t\t/**\n\t\t * @type {UVConfig}\n\t\t */\n\t\tconst config = global.__uv$config;\n\n\t\t// register sw\n\t\tthis.possible_error('Failure registering the UltraViolet Service Worker.');\n\t\tawait navigator.serviceWorker.register('/uv/sw.js', {\n\t\t\tscope: config.prefix,\n\t\t\t// cache sucks\n\t\t\t// we have plenty of bandwidth to spare\n\t\t\tupdateViaCache: 'none',\n\t\t});\n\t\tawait this.possible_error();\n\n\t\tawait this.possible_error('Bare server is unreachable.');\n\t\t{\n\t\t\tconst bare = await fetch(BARE_API);\n\t\t\tif (!bare.ok) {\n\t\t\t\tthrow await bare.json();\n\t\t\t}\n\t\t}\n\t\tawait this.possible_error();\n\n\t\tthis.redirect(\n\t\t\tnew URL(\n\t\t\t\tconfig.encodeUrl(this.destination),\n\t\t\t\tnew URL(config.prefix, global.location)\n\t\t\t)\n\t\t);\n\t}\n}\n\nexport default wrapCompat(Ultraviolet);\n"],"names":["CompatModule","layout","Layout","container","createRef","state","error","undefined","possible_error","name","scripts","Map","src","this","has","Promise","resolve","script","document","createElement","async","promise","reject","addEventListener","body","append","set","props","location","hash","Error","URL","slice","url","global","assign","_componentDidMount","console","setState","stack","remove","delete","message","description","set_page","ref","href","onClick","event","preventDefault","reload","to","resolveRoute","target","Component","wrapCompat","Element","forwardRef","useLocation","Ultraviolet","load_script","config","__uv$config","navigator","serviceWorker","register","scope","prefix","updateViaCache","fetch","BARE_API","bare","ok","json","redirect","encodeUrl","destination"],"sourceRoot":""}