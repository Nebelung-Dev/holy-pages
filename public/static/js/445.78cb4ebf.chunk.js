"use strict";(self.webpackChunkholyunblocker_website=self.webpackChunkholyunblocker_website||[]).push([[445],{3445:function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var r=n(37),s=n(8427),a=n.n(s),i=n(5474),c=n(57),o=n(9592),u=n(6931),h=function(){function e(t,n){(0,o.Z)(this,e),this.server=t,this.signal=n}return(0,u.Z)(e,[{key:"get",value:function(){var e=(0,r.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.password&&(t.includes("?")?t+="&pwd="+this.password:t+="?pwd="+this.password),e.prev=1,e.next=4,fetch(new URL(t,this.server),{signal:this.signal});case 4:if(200!==(n=e.sent).status){e.next=11;break}return e.next=8,n.text();case 8:return e.abrupt("return",e.sent);case 11:return e.t0=Error,e.t1='unexpected server response to not match "200". Server says "',e.next=15,n.text();case 15:throw e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2,'"'),new e.t0(e.t3);case 18:e.next=24;break;case 20:throw e.prev=20,e.t4=e.catch(1),console.error(e.t4),new Error("Cannot communicate with the server");case 24:case"end":return e.stop()}}),e,this,[[1,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"needpassword",value:function(){var e=(0,r.Z)(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("needpassword");case 2:return t=e.sent,e.abrupt("return","true"===t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"newsession",value:function(){var e=(0,r.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("newsession");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"editsession",value:function(){var e=(0,r.Z)(a().mark((function e(t,n,r){var s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("editsession?id="+encodeURIComponent(t)+(n?"&httpProxy="+encodeURIComponent(n):"")+"&enableShuffling="+(r?"1":"0"));case 2:if("Success"===(s=e.sent)){e.next=5;break}throw new Error("unexpected response from server. received ".concat(s));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"sessionexists",value:function(){var e=(0,r.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("sessionexists?id="+encodeURIComponent(t));case 2:n=e.sent,e.t0=n,e.next="exists"===e.t0?6:"not found"===e.t0?7:8;break;case 6:return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:throw new Error("unexpected response from server. received ".concat(n));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deletesession",value:function(){var e=(0,r.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sessionexists(t);case 2:if(!e.sent){e.next=8;break}return e.next=5,this.get("deletesession?id="+t);case 5:if("Success"===(n=e.sent)||"not found"===n){e.next=8;break}throw new Error("unexpected response from server. received ".concat(n));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"shuffleDict",value:function(){var e=(0,r.Z)(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.get("api/shuffleDict?id="+encodeURIComponent(t));case 2:return n=e.sent,e.abrupt("return",JSON.parse(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.generateDictionary();(0,o.Z)(this,e),this.baseDictionary="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~-",this.shuffledIndicator="_rhs",this.dictionary=t}return(0,u.Z)(e,[{key:"mod",value:function(e,t){return(e%t+t)%t}},{key:"generateDictionary",value:function(){for(var e="",t=this.baseDictionary.split("");t.length>0;)e+=t.splice(Math.floor(Math.random()*t.length),1)[0];return e}},{key:"shuffle",value:function(e){if((e=e.toString()).startsWith(this.shuffledIndicator))return e;for(var t="",n=0;n<e.length;n++){var r=e.charAt(n),s=this.baseDictionary.indexOf(r);"%"===r&&e.length-n>=3?(t+=r,t+=e.charAt(++n),t+=e.charAt(++n)):t+=-1===s?r:this.dictionary.charAt(this.mod(s+n,this.baseDictionary.length))}return this.shuffledIndicator+t}},{key:"unshuffle",value:function(e){if(!e.startsWith(this.shuffledIndicator))return e;e=e.slice(this.shuffledIndicator.length);for(var t="",n=0;n<e.length;n++){var r=e.charAt(n),s=this.dictionary.indexOf(r);"%"===r&&e.length-n>=3?(t+=r,t+=e.charAt(++n),t+=e.charAt(++n)):t+=-1===s?r:this.baseDictionary.charAt(this.mod(s-n,this.baseDictionary.length))}return t}}]),e}(),d=n(3285),l=n(1394);function p(e){return(0,i.useEffect)((function(){(0,r.Z)(a().mark((function t(){var r,s,i,c,o,u;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,s=new h(d.TH),r="Rammerhead server is unreachable.",t.next=5,fetch(d.TH);case 5:if(r=void 0,r="Unable to check if the saved session exists.",t.t0=!localStorage.rammerhead_session,t.t0){t.next=12;break}return t.next=11,s.sessionexists(localStorage.rammerhead_session);case 11:t.t0=!t.sent;case 12:if(!t.t0){t.next=19;break}return r="Unable to create a new Rammerhead session.",t.next=16,s.newsession();case 16:i=t.sent,r=void 0,localStorage.rammerhead_session=i;case 19:return c=localStorage.rammerhead_session,r=void 0,r="Unable to edit a Rammerhead session.",t.next=24,s.editsession(c,!1,!0);case 24:return r=void 0,r="Unable to retrieve shuffled dictionary.",t.next=28,s.shuffleDict(c);case 28:o=t.sent,r=void 0,u=new f(o),n.g.location.assign(new URL("".concat(c,"/").concat(u.shuffle(e.compat_layout.current.destination)),d.TH)),t.next=37;break;case 34:t.prev=34,t.t1=t.catch(0),e.compat_layout.current.report(t.t1,r,"Rammerhead");case 37:case"end":return t.stop()}}),t,null,[[0,34]])})))()}),[e.compat_layout]),(0,l.jsxs)("main",{className:"compat",children:["Loading ",(0,l.jsx)(c.mj,{children:"Rammerhead"}),"..."]})}}}]);
//# sourceMappingURL=445.78cb4ebf.chunk.js.map