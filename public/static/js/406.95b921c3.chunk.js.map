{"version":3,"file":"static/js/406.95b921c3.chunk.js","mappings":"+PA4Be,SAASA,EAAYC,GACnC,IAAMC,GAAYC,EAAAA,EAAAA,UACZC,GAAYD,EAAAA,EAAAA,UA+ClB,OA7CAE,EAAAA,EAAAA,YAAU,YACJ,iBAAC,wGAIJC,EAAc,0CAJV,SAKEJ,EAAUK,QAAQC,QALpB,cAMJF,OAAcG,EAKRC,EAASC,EAAAA,EAAOC,YAGtBN,EAAc,sDAdV,SAeEO,UAAUC,cAAcC,SAAS,YAAa,CACnDC,MAAON,EAAOO,OAGdC,eAAgB,SAnBb,cAqBJZ,OAAcG,EAEdH,EAAc,8BAvBV,UAyBgBa,MAAMC,EAAAA,IAzBtB,YAyBGC,EAzBH,QA0BOC,GA1BP,kCA2BUD,EAAKE,OA3Bf,6BA8BJjB,OAAcG,EAEdE,EAAAA,EAAOa,SAASC,OACf,IAAIC,IACHhB,EAAOiB,UAAU1B,EAAM2B,cAAcrB,QAAQsB,aAC7C,IAAIH,IAAIhB,EAAOO,OAAQN,EAAAA,EAAOa,YAnC5B,kDAuCJvB,EAAM2B,cAAcrB,QAAQuB,OAA5B,KAA0CxB,EAAa,SAvCnD,yDAAD,KA0CH,CAACL,EAAM2B,cAAe1B,EAAWE,KAGnC,kBAAM2B,UAAU,SAAhB,WACC,UAAC,KAAD,CAAcC,IAAK9B,EAAnB,WACC,SAAC,KAAD,CAAQ+B,IAAI,sBACZ,SAAC,KAAD,CAAQA,IAAI,wBAHd,YAKS,SAAC,KAAD,0BALT","sources":["pages/compat/Ultraviolet.js"],"sourcesContent":["import { useEffect, useRef } from 'react';\nimport { ScriptsOrder, Script } from '../../CompatLayout.js';\nimport { Obfuscated } from '../../obfuscate.js';\nimport { BARE_API } from '../../root.js';\n\n/**\n * @callback UVEncode\n * @argument {string} decoded\n * @returns {string} encoded\n */\n\n/**\n * @callback UVDecode\n * @argument {string} encoded\n * @returns {string} decoded\n */\n\n/**\n * @typedef {object} UVConfig\n * @property {string} bare\n * @property {string} handler\n * @property {string} bundle\n * @property {string} config\n * @property {string} sw\n * @property {UVEncode} encodeUrl\n * @property {UVDecode} decodeUrl\n */\n\nexport default function Ultraviolet(props) {\n\tconst uv_bundle = useRef();\n\tconst uv_config = useRef();\n\n\tuseEffect(() => {\n\t\tvoid (async function () {\n\t\t\tlet error_cause;\n\n\t\t\ttry {\n\t\t\t\terror_cause = 'Failure loading the Ultraviolet bundle.';\n\t\t\t\tawait uv_bundle.current.promise;\n\t\t\t\terror_cause = undefined;\n\n\t\t\t\t/**\n\t\t\t\t * @type {UVConfig}\n\t\t\t\t */\n\t\t\t\tconst config = global.__uv$config;\n\n\t\t\t\t// register sw\n\t\t\t\terror_cause = 'Failure registering the Ultraviolet Service Worker.';\n\t\t\t\tawait navigator.serviceWorker.register('/uv/sw.js', {\n\t\t\t\t\tscope: config.prefix,\n\t\t\t\t\t// cache sucks\n\t\t\t\t\t// we have plenty of bandwidth to spare\n\t\t\t\t\tupdateViaCache: 'none',\n\t\t\t\t});\n\t\t\t\terror_cause = undefined;\n\n\t\t\t\terror_cause = 'Bare server is unreachable.';\n\t\t\t\t{\n\t\t\t\t\tconst bare = await fetch(BARE_API);\n\t\t\t\t\tif (!bare.ok) {\n\t\t\t\t\t\tthrow await bare.json();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\terror_cause = undefined;\n\n\t\t\t\tglobal.location.assign(\n\t\t\t\t\tnew URL(\n\t\t\t\t\t\tconfig.encodeUrl(props.compat_layout.current.destination),\n\t\t\t\t\t\tnew URL(config.prefix, global.location)\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t} catch (error) {\n\t\t\t\tprops.compat_layout.current.report(error, error_cause, 'Stomp');\n\t\t\t}\n\t\t})();\n\t}, [props.compat_layout, uv_bundle, uv_config]);\n\n\treturn (\n\t\t<main className=\"compat\">\n\t\t\t<ScriptsOrder ref={uv_bundle}>\n\t\t\t\t<Script src=\"/uv/uv.bundle.js\" />\n\t\t\t\t<Script src=\"/uv/uv.config.js\" />\n\t\t\t</ScriptsOrder>\n\t\t\tLoading <Obfuscated>Ultraviolet</Obfuscated>...\n\t\t</main>\n\t);\n}\n"],"names":["Ultraviolet","props","uv_bundle","useRef","uv_config","useEffect","error_cause","current","promise","undefined","config","global","__uv$config","navigator","serviceWorker","register","scope","prefix","updateViaCache","fetch","BARE_API","bare","ok","json","location","assign","URL","encodeUrl","compat_layout","destination","report","className","ref","src"],"sourceRoot":""}