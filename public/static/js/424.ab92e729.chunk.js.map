{"version":3,"file":"static/js/424.ab92e729.chunk.js","mappings":"sRAUqBA,EAAAA,WACpB,WAAYC,IAAS,eACpBC,KAAKD,OAASA,EA0Bf,OAnBG,EAAJ,qEACC,WAAmBE,EAASC,GAA5B,uFACwBC,MACtB,IAAIC,IAAJ,qBAAsBH,EAAtB,KAAkCD,KAAKD,QACvC,CAAEG,OAAAA,IAHJ,WACOG,EADP,QAMeC,GANf,gCAOcD,EAASE,OAPvB,2CAUcF,EAASE,OAVvB,8IADD,IAkBA,+DACC,WAAqBN,EAASO,EAAQN,GAAtC,uFACwBC,MACtB,IAAIC,IAAJ,qBAAsBH,EAAtB,KAAkCD,KAAKD,QACvC,CAAEG,OAAAA,EAAQO,OAAQ,OAAQC,KAAMC,KAAKC,UAAU,CAAEJ,OAAAA,MAHnD,WACOH,EADP,QAMeC,GANf,gCAOcD,EAASE,OAPvB,2CAUcF,EAASE,OAVvB,gJADD,MACC,EA5BoBT,G,SCJAe,EAAAA,SAAAA,IAAAA,EAAAA,EAAAA,GAAAA,EAAAA,GAAAA,IAAAA,GAAAA,EAAAA,EAAAA,GAAAA,GAKpB,WAAYC,GAAQ,IAAD,yBAClB,cAAMA,IALPb,SAAUc,EAAAA,EAAAA,aAIS,EAHnBP,QAASO,EAAAA,EAAAA,aAGU,EAFnBC,IAAM,IAAIlB,EAAWmB,EAAAA,IAEF,EADnBC,MAAQ,IAAIC,gBAIX,EAAKC,MAAQ,GAHK,EAmFlB,OA/EA,8BACD,WAAU,IAAD,OAGR,OAFAC,EAAAA,EAAAA,IAAS,kBAGR,6BACC,4FACkE,KACjE,SAAC,KAAD,CAAaC,KAAMC,EAAAA,GAAnB,kBAFD,QAIA,kBACCC,SAAQ,mCAAE,WAAMC,GAAN,wEACTA,EAAMC,iBACN,EAAKR,MAAMA,QACX,EAAKA,MAAQ,IAAIC,gBAHR,kBASF,EAAKH,IAAIW,eACd,EAAK1B,QAAQ2B,QAAQC,MACrB,EAAKrB,OAAOoB,QAAQC,MACpB,EAAKX,MAAMhB,QAZJ,uDAgBW,8BAAlB,KAAM4B,SACY,gCAAlB,KAAMA,UAENC,QAAQC,MAAR,MAEA,EAAKC,SAAS,CACbD,MAAK,QAtBC,yDAAF,sDA2BRE,UAAU,SA5BX,WA8BC,kBACCC,UAAQ,iBAAE,6FACT,EAAKjB,MAAMA,QACX,EAAKA,MAAQ,IAAIC,gBAFR,kBAKc,EAAKH,IAAIoB,aAC9B,EAAKnC,QAAQ2B,QAAQC,MACrB,EAAKX,MAAMhB,QAPJ,gBAKAmC,EALA,EAKAA,IAKR,EAAKJ,SAAS,CACbI,IAAAA,IAXO,kDAcc,gCAAlB,KAAMP,UACTC,QAAQC,MAAR,MAEA,EAAKC,SAAS,CACbD,MAAK,QAlBC,0DAuBVM,IAAKtC,KAAKC,QACVsC,YAAY,UACZL,UAAU,iBAEX,iBAAKA,UAAU,kBAAf,WACC,kBAAOK,YAAY,SAASD,IAAKtC,KAAKQ,UACtC,gBAAK0B,UAAU,MAAf,SAAsBlC,KAAKoB,MAAMiB,KAAO,aAEzC,mBAAQG,KAAK,SAAb,qBACA,gBAAKN,UAAU,QAAf,cACuBO,IAArBzC,KAAKoB,MAAMY,OAAuBhC,KAAKoB,MAAMY,MAAMU,uBAKxD,EAxFmB7B,CAAqB8B,EAAAA","sources":["VoucherAPI.js","pages/PrivateLinks.js"],"sourcesContent":["/**\n * @typedef {object} Voucher\n * @property {string} tld\n */\n\n/**\n * @typedef {object} RedeemedVoucher\n * @property {string} hash\n */\n\nexport default class VoucherAPI {\n\tconstructor(server) {\n\t\tthis.server = server;\n\t}\n\t/**\n\t *\n\t * @param {string} voucher\n\t * @param {AbortSignal} [signal]\n\t * @returns {Voucher}\n\t */\n\tasync show_voucher(voucher, signal) {\n\t\tconst outgoing = await fetch(\n\t\t\tnew URL(`./vouchers/${voucher}/`, this.server),\n\t\t\t{ signal }\n\t\t);\n\n\t\tif (!outgoing.ok) {\n\t\t\tthrow await outgoing.json();\n\t\t}\n\n\t\treturn await outgoing.json();\n\t}\n\t/**\n\t *\n\t * @param {string} voucher\n\t * @param {AbortSignal} [signal]\n\t * @returns {RedeemedVoucher}\n\t */\n\tasync redeem_voucher(voucher, domain, signal) {\n\t\tconst outgoing = await fetch(\n\t\t\tnew URL(`./vouchers/${voucher}/`, this.server),\n\t\t\t{ signal, method: 'POST', body: JSON.stringify({ domain }) }\n\t\t);\n\n\t\tif (!outgoing.ok) {\n\t\t\tthrow await outgoing.json();\n\t\t}\n\n\t\treturn await outgoing.json();\n\t}\n}\n","import { Component, createRef } from 'react';\nimport { ObfuscatedA } from '../obfuscate.js';\nimport { set_page, VOUCHER_URL, VO_API } from '../root.js';\nimport VoucherAPI from '../VoucherAPI.js';\nimport '../styles/PrivateLinks.scss';\n\nexport default class PrivateLinks extends Component {\n\tvoucher = createRef();\n\tdomain = createRef();\n\tapi = new VoucherAPI(VO_API);\n\tabort = new AbortController();\n\tconstructor(props) {\n\t\tsuper(props);\n\n\t\tthis.state = {};\n\t}\n\trender() {\n\t\tset_page('private-links');\n\n\t\treturn (\n\t\t\t<main>\n\t\t\t\t<p>\n\t\t\t\t\tTo use this service, you will need a voucher. Purchase a voucher{' '}\n\t\t\t\t\t<ObfuscatedA href={VOUCHER_URL}>here</ObfuscatedA>.\n\t\t\t\t</p>\n\t\t\t\t<form\n\t\t\t\t\tonSubmit={async event => {\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\tthis.abort.abort();\n\t\t\t\t\t\tthis.abort = new AbortController();\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t// PLACEHOLDER\n\t\t\t\t\t\t\t// no idea what to do with this data...\n\t\t\t\t\t\t\t// see https://discord.com/channels/956789074121863178/957489824909111317/972748339223334962\n\t\t\t\t\t\t\tawait this.api.redeem_voucher(\n\t\t\t\t\t\t\t\tthis.voucher.current.value,\n\t\t\t\t\t\t\t\tthis.domain.current.value,\n\t\t\t\t\t\t\t\tthis.abort.signal\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\terror.message !== 'The operation was aborted' &&\n\t\t\t\t\t\t\t\terror.message !== 'The user aborted a request.'\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tconsole.error(error);\n\n\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\t\terror,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\tclassName=\"redeem\"\n\t\t\t\t>\n\t\t\t\t\t<input\n\t\t\t\t\t\tonChange={async () => {\n\t\t\t\t\t\t\tthis.abort.abort();\n\t\t\t\t\t\t\tthis.abort = new AbortController();\n\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tconst { tld } = await this.api.show_voucher(\n\t\t\t\t\t\t\t\t\tthis.voucher.current.value,\n\t\t\t\t\t\t\t\t\tthis.abort.signal\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\t\ttld,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\tif (error.message !== 'The user aborted a request.') {\n\t\t\t\t\t\t\t\t\tconsole.error(error);\n\n\t\t\t\t\t\t\t\t\tthis.setState({\n\t\t\t\t\t\t\t\t\t\terror,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tref={this.voucher}\n\t\t\t\t\t\tplaceholder=\"Voucher\"\n\t\t\t\t\t\tclassName=\"theme-input\"\n\t\t\t\t\t></input>\n\t\t\t\t\t<div className=\"theme-input-bar\">\n\t\t\t\t\t\t<input placeholder=\"Domain\" ref={this.domain}></input>\n\t\t\t\t\t\t<div className=\"tld\">{this.state.tld || '.com'}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button type=\"submit\">Redeem</button>\n\t\t\t\t\t<div className=\"error\">\n\t\t\t\t\t\t{this.state.error !== undefined && this.state.error.toString()}\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</main>\n\t\t);\n\t}\n}\n"],"names":["VoucherAPI","server","this","voucher","signal","fetch","URL","outgoing","ok","json","domain","method","body","JSON","stringify","PrivateLinks","props","createRef","api","VO_API","abort","AbortController","state","set_page","href","VOUCHER_URL","onSubmit","event","preventDefault","redeem_voucher","current","value","message","console","error","setState","className","onChange","show_voucher","tld","ref","placeholder","type","undefined","toString","Component"],"sourceRoot":""}