"use strict";(self.webpackChunkholyunblocker_website=self.webpackChunkholyunblocker_website||[]).push([[671],{6740:function(e,t,n){n.d(t,{$0:function(){return k},_V:function(){return m},sr:function(){return y}});var r=n(7762),a=n(885),s=n(5861),i=n(5671),c=n(3144),u=n(7757),o=n.n(u),l=n(2791),h=n(3504),f=n(5829),d=n(9040),v=n(184),m=function(){function e(t){(0,i.Z)(this,e),this.server=t}return(0,c.Z)(e,[{key:"game",value:function(){var e=(0,s.Z)(o().mark((function e(t){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(new URL("./games/".concat(t,"/"),this.server));case 2:if((n=e.sent).ok){e.next=7;break}return e.next=6,n.json();case 6:throw e.sent;case 7:return e.next=9,n.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"game_plays",value:function(){var e=(0,s.Z)(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(new URL("./games/".concat(t,"/plays?")+new URLSearchParams({token:n}),this.server),{method:"PUT"});case 2:if((r=e.sent).ok){e.next=7;break}return e.next=6,r.json();case 6:throw e.sent;case 7:return e.next=9,r.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"sort_params",value:function(e){for(var t in e)switch(typeof e[t]){case"undefined":case"object":delete e[t]}return e}},{key:"category",value:function(){var e=(0,s.Z)(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(new URL("./games/?"+new URLSearchParams(this.sort_params(t)),this.server),{signal:n});case 2:if((r=e.sent).ok){e.next=7;break}return e.next=6,r.json();case 6:throw e.sent;case 7:return e.next=9,r.json();case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function p(e){var t=(0,l.useState)(!1),n=(0,a.Z)(t,2),r=n[0],s=n[1];return(0,v.jsx)(h.rU,{to:"".concat((0,d.k)("/games/","player"),"?id=").concat(e.id),onClick:function(){return e.layout.current.setState({expanded:!1})},children:(0,v.jsxs)("div",{className:"item",children:[(0,v.jsx)("div",{className:"thumbnail",children:(0,v.jsx)("img",{alt:"",loading:"lazy",onLoad:function(){return s(!0)},"data-loaded":Number(r),src:"/thumbnails/".concat(e.id,".webp")})}),(0,v.jsx)("div",{className:"name",children:(0,v.jsx)(f.mj,{ellipsis:!0,children:e.name})})]})})}function x(e){return(0,v.jsxs)("div",{className:"item loading",children:[(0,v.jsx)("div",{className:"thumbnail"}),(0,v.jsx)("div",{className:"name"})]})}function y(e){var t,n=[],a=(0,r.Z)(e.items);try{for(a.s();!(t=a.n()).done;){var s=t.value;s.loading?n.push((0,v.jsx)(x,{id:s.id,layout:e.layout},s.id)):n.push((0,v.jsx)(p,{id:s.id,name:s.name,layout:e.layout},s.id))}}catch(i){a.e(i)}finally{a.f()}return n}function k(e){return(0,v.jsxs)("section",{children:[(0,v.jsx)("div",{className:"name",children:(0,v.jsx)("h1",{children:e.name})}),(0,v.jsx)("div",{className:"items",children:(0,v.jsx)(y,{items:e.items,layout:e.layout})})]})}},3671:function(e,t,n){n.r(t),n.d(t,{default:function(){return x}});var r=n(5861),a=n(7762),s=n(5671),i=n(3144),c=n(136),u=n(3668),o=n(7757),l=n.n(o),h=n(2791),f=n(9911),d=n(6740),v=n(8424),m=(n(3415),n(184)),p=/TypeError: Failed to fetch/,x=function(e){(0,c.Z)(n,e);var t=(0,u.Z)(n);function n(e){var r;(0,s.Z)(this,n),(r=t.call(this,e)).api=new d._V(f.YA),r.settings=new v.Z("common games",{favorites:[],seen:[]}),r.abort=new AbortController;var i,c=[],u=(0,a.Z)(r.set_favorites);try{for(u.s();!(i=u.n()).done;){var o=i.value;c.push({loading:!0,id:o})}}catch(l){u.e(l)}finally{u.f()}return r.state={data:c},r}return(0,i.Z)(n,[{key:"layout",get:function(){return this.props.layout}},{key:"set_favorites",get:function(){return this.settings.get("favorites")}},{key:"fetch",value:function(){var e=(0,r.Z)(l().mark((function e(){var t,n,r,s,i;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=this.set_favorites,r=(0,a.Z)(n),e.prev=3,r.s();case 5:if((s=r.n()).done){e.next=20;break}return i=s.value,e.prev=7,e.t0=t,e.next=11,this.api.game(i);case 11:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=18;break;case 15:e.prev=15,e.t2=e.catch(7),p.test(e.t2)||(console.warn("Unable to fetch game:",i,e.t2),n.splice(n.indexOf(i),1));case 18:e.next=5;break;case 20:e.next=25;break;case 22:e.prev=22,e.t3=e.catch(3),r.e(e.t3);case 25:return e.prev=25,r.f(),e.finish(25);case 28:return this.settings.set("favorites",n),e.abrupt("return",this.setState({data:t}));case 30:case"end":return e.stop()}}),e,this,[[3,22,25,28],[7,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.fetch()}},{key:"componentWillUnmount",value:function(){this.abort.abort()}},{key:"render",value:function(){return(0,f.jQ)("games-category"),0===this.set_favorites.length?(0,m.jsx)("main",{children:(0,m.jsx)("span",{className:"no-games",children:"You haven't added any favorite games."})}):(0,m.jsx)("main",{children:(0,m.jsx)(d.$0,{name:"Favorites",items:this.state.data,layout:this.layout})})}}]),n}(h.Component)},3415:function(){}}]);
//# sourceMappingURL=671.741889d0.chunk.js.map