{"version":3,"file":"static/js/789.27445f89.chunk.js","mappings":"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","sources":["GamesCommon.js","ProxyResolver.js","../node_modules/@mui/icons-material/esm/ArrowDropUp.js","../node_modules/@mui/icons-material/esm/ArrowLeft.js","../node_modules/@mui/icons-material/esm/ArrowDropDown.js","../node_modules/@mui/icons-material/esm/ArrowRight.js","../node_modules/@mui/icons-material/esm/Close.js","../node_modules/@mui/icons-material/esm/VideogameAsset.js","../node_modules/@mui/icons-material/esm/Star.js","../node_modules/@mui/icons-material/esm/StarBorder.js","../node_modules/@mui/icons-material/esm/Panorama.js","pages/theatre/Player.js","../node_modules/@mui/icons-material/esm/ChevronLeft.js","../node_modules/@mui/icons-material/esm/Fullscreen.js"],"sourcesContent":["import { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { Obfuscated } from './obfuscate.js';\nimport resolveRoute from './resolveRoute.js';\n\n/**\n *\n * @typedef {object} GamesCategoryParams\n\n */\n\n/**\n *\n * @typedef {object} LimitedGame\n * @property {string} name\n * @property {string} id\n * @property {string} category\n */\n\n/**\n *\n * @typedef {LimitedGame[]} GamesCategory\n */\n\nexport class GamesAPI {\n\t/**\n\t *\n\t * @param {string} server\n\t * @param {AbortSignal} [signal]\n\t */\n\tconstructor(server, signal) {\n\t\tthis.server = server;\n\t\tthis.signal = signal;\n\t}\n\t/**\n\t *\n\t * @param {string} url\n\t * @param {object} init\n\t * @returns\n\t */\n\tasync fetch(url, init = {}) {\n\t\treturn await fetch(new URL(url, this.server), {\n\t\t\t...init,\n\t\t\tsignal: this.signal,\n\t\t});\n\t}\n\t/**\n\t *\n\t * @param {string} id\n\t * @returns {LimitedGame}\n\t */\n\tasync game(id) {\n\t\tconst outgoing = await this.fetch(`./games/${id}/`);\n\n\t\tconst json = await outgoing.json();\n\n\t\tif (!outgoing.ok) {\n\t\t\tthrow new Error(json.message || json.error);\n\t\t}\n\n\t\treturn json;\n\t}\n\t/**\n\t *\n\t * @param {string} id\n\t * @param {string} token\n\t * @returns {LimitedGame}\n\t */\n\tasync game_plays(id, token) {\n\t\tconst outgoing = await this.fetch(\n\t\t\t`./games/${id}/plays?` +\n\t\t\t\tnew URLSearchParams({\n\t\t\t\t\ttoken,\n\t\t\t\t}),\n\t\t\t{\n\t\t\t\tmethod: 'PUT',\n\t\t\t}\n\t\t);\n\n\t\tconst json = await outgoing.json();\n\n\t\tif (!outgoing.ok) {\n\t\t\tthrow new Error(json.message || json.error);\n\t\t}\n\n\t\treturn json;\n\t}\n\tsort_params(params) {\n\t\tfor (let param in params) {\n\t\t\tswitch (typeof params[param]) {\n\t\t\t\tcase 'undefined':\n\t\t\t\tcase 'object':\n\t\t\t\t\tdelete params[param];\n\t\t\t\t\tbreak;\n\t\t\t\t// no default\n\t\t\t}\n\t\t}\n\n\t\treturn params;\n\t}\n\t/**\n\t *\n\t * @param {{leastGreatest?:boolean,category?:string[],sort?:string,search?:string,limit?:number,limitPerCategory:?number}} params\n\t * @returns {GamesCategory}\n\t */\n\tasync category(params) {\n\t\tconst outgoing = await this.fetch(\n\t\t\t'./games/?' + new URLSearchParams(this.sort_params(params))\n\t\t);\n\n\t\tconst json = await outgoing.json();\n\n\t\tif (!outgoing.ok) {\n\t\t\tthrow new Error(json.message || json.error);\n\t\t}\n\n\t\treturn json;\n\t}\n}\n\nfunction Item(props) {\n\tconst [loaded, set_loaded] = useState(false);\n\n\treturn (\n\t\t<Link\n\t\t\tclassName=\"item\"\n\t\t\tto={`${resolveRoute('/theatre/', 'player')}?id=${props.id}`}\n\t\t>\n\t\t\t<div className=\"thumbnail\" data-loaded={Number(loaded)}>\n\t\t\t\t<img\n\t\t\t\t\talt=\"\"\n\t\t\t\t\tloading=\"lazy\"\n\t\t\t\t\tonLoad={() => set_loaded(true)}\n\t\t\t\t\tsrc={`/thumbnails/${props.id}.webp`}\n\t\t\t\t></img>\n\t\t\t</div>\n\t\t\t<div className=\"name\">\n\t\t\t\t<Obfuscated ellipsis>{props.name}</Obfuscated>\n\t\t\t</div>\n\t\t</Link>\n\t);\n}\n\nfunction LoadingItem() {\n\treturn (\n\t\t<div className=\"item loading\">\n\t\t\t<div className=\"thumbnail\" />\n\t\t\t<div className=\"name\" />\n\t\t</div>\n\t);\n}\n\n/**\n * @param {React.DetailedHTMLProps<React.HTMLAttributes<HTMLDivElement>, HTMLDivElement> & {items: {id:string,name?:string,loading:boolean}}} props\n * @returns\n */\nexport function ItemList(props) {\n\tconst { items, ...attributes } = props;\n\n\tconst children = [];\n\n\tfor (let item of items) {\n\t\tif (item.loading) {\n\t\t\tchildren.push(<LoadingItem key={item.id} id={item.id} />);\n\t\t} else {\n\t\t\tchildren.push(<Item key={item.id} id={item.id} name={item.name} />);\n\t\t}\n\t}\n\n\treturn <div {...attributes}>{children}</div>;\n}\n","import { DB_API, DEFAULT_PROXY } from './root.js';\nimport resolveRoute from './resolveRoute.js';\n\nexport class CompatAPI {\n\tconstructor(server) {\n\t\tthis.server = server;\n\t}\n\tasync compat(host) {\n\t\tconst outgoing = await fetch(new URL(`./compat/${host}/`, this.server));\n\n\t\tconst json = await outgoing.json();\n\n\t\tif (!outgoing.ok) {\n\t\t\tthrow new Error(json.message || json.error);\n\t\t}\n\n\t\treturn json;\n\t}\n\tsort_params(params) {\n\t\tfor (let param in params) {\n\t\t\tswitch (typeof params[param]) {\n\t\t\t\tcase 'undefined':\n\t\t\t\tcase 'object':\n\t\t\t\t\tdelete params[param];\n\t\t\t\t\tbreak;\n\t\t\t\t// no default\n\t\t\t}\n\t\t}\n\n\t\treturn params;\n\t}\n\t/**\n\t *\n\t * @param {GamesCategoryParams} params\n\t * @param {AbortSignal} signal\n\t * @returns {GamesCategory}\n\t */\n\tasync category(params, signal) {\n\t\tconst outgoing = await fetch(\n\t\t\tnew URL(\n\t\t\t\t'./games/?' + new URLSearchParams(this.sort_params(params)),\n\t\t\t\tthis.server\n\t\t\t),\n\t\t\t{ signal }\n\t\t);\n\n\t\tconst json = await outgoing.json();\n\n\t\tif (!outgoing.ok) {\n\t\t\tthrow new Error(json.message || json.error);\n\t\t}\n\n\t\treturn json;\n\t}\n}\n\n/**\n *\n * @param {string} src\n * @param {string} setting\n * @returns {string}\n */\nexport default async function resolve_proxy(src, setting) {\n\tif (setting === 'automatic') {\n\t\tconst { host } = new URL(src);\n\t\tconst api = new CompatAPI(DB_API);\n\n\t\ttry {\n\t\t\tsetting = (await api.compat(host)).proxy;\n\t\t} catch (error) {\n\t\t\tsetting = DEFAULT_PROXY;\n\t\t}\n\t}\n\n\tlet route;\n\n\tswitch (setting) {\n\t\tcase 'stomp':\n\t\t\troute = resolveRoute('/compat/', 'stomp');\n\t\t\tbreak;\n\t\tcase 'ultraviolet':\n\t\t\troute = resolveRoute('/compat/', 'ultraviolet');\n\t\t\tbreak;\n\t\tdefault:\n\t\tcase 'rammerhead':\n\t\t\troute = resolveRoute('/compat/', 'rammerhead');\n\t\t\tbreak;\n\t}\n\n\treturn `${route}#${src}`;\n}\n","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"m7 14 5-5 5 5z\"\n}), 'ArrowDropUp');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"m14 7-5 5 5 5V7z\"\n}), 'ArrowLeft');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"m7 10 5 5 5-5z\"\n}), 'ArrowDropDown');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"m10 17 5-5-5-5v10z\"\n}), 'ArrowRight');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"\n}), 'Close');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M21 6H3c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-10 7H8v3H6v-3H3v-2h3V8h2v3h3v2zm4.5 2c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5zm4-3c-.83 0-1.5-.67-1.5-1.5S18.67 9 19.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z\"\n}), 'VideogameAsset');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z\"\n}), 'Star');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"m22 9.24-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z\"\n}), 'StarBorder');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M23 18V6c0-1.1-.9-2-2-2H3c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2zM8.5 12.5l2.5 3.01L14.5 11l4.5 6H5l3.5-4.5z\"\n}), 'Panorama');","import { useEffect, useRef, useState } from 'react';\nimport { Obfuscated } from '../../obfuscate.js';\nimport { DB_API, GAMES_CDN } from '../../root.js';\nimport resolve_proxy from '../../ProxyResolver.js';\nimport { GamesAPI } from '../../GamesCommon.js';\nimport '../../styles/TheatrePlayer.scss';\nimport {\n\tArrowDropDown,\n\tArrowDropUp,\n\tArrowLeft,\n\tArrowRight,\n\tChevronLeft,\n\tClose,\n\tFullscreen,\n\tPanorama,\n\tStar,\n\tStarBorder,\n\tVideogameAsset,\n} from '@mui/icons-material';\nimport resolveRoute from '../../resolveRoute.js';\n\nasync function resolve_game(src, type, setting) {\n\tswitch (type) {\n\t\tcase 'proxy':\n\t\t\treturn await resolve_proxy(src, setting);\n\t\tcase 'embed':\n\t\t\treturn src;\n\t\tcase 'flash':\n\t\t\treturn `${resolveRoute('/compat/', 'flash')}#${src} `;\n\t\tcase 'emulator':\n\t\tcase 'emulator.gba':\n\t\tcase 'emulator.nes':\n\t\tcase 'emulator.genesis':\n\t\t\treturn new URL(\n\t\t\t\t'./html5/webretro/?' +\n\t\t\t\t\tnew URLSearchParams({\n\t\t\t\t\t\trom: src,\n\t\t\t\t\t\tcore: 'autodetect',\n\t\t\t\t\t}),\n\t\t\t\tGAMES_CDN\n\t\t\t).toString();\n\t\tdefault:\n\t\t\tthrow new TypeError(`Unrecognized target: ${type}`);\n\t}\n}\n\nexport default function Player(props) {\n\tconst [favorited, set_favorited] = useState(() =>\n\t\tprops.layout.current.settings.favorite_games.includes(props.id)\n\t);\n\tconst [panorama, set_panorama] = useState(false);\n\tconst [controls_expanded, set_controls_expanded] = useState(false);\n\tconst [error, set_error] = useState();\n\tconst error_cause = useRef();\n\tconst [data, set_data] = useState();\n\tconst iframe = useRef();\n\tconst controls_open = useRef();\n\tconst [resolved_src, set_resolved_src] = useState();\n\tconst controls_popup = useRef();\n\tconst [seen, _set_seen] = useState(() =>\n\t\tprops.layout.current.settings.seen_games.includes(props.id)\n\t);\n\n\tuseEffect(() => {\n\t\tconst abort = new AbortController();\n\n\t\tasync function set_seen(value) {\n\t\t\tconst seen = props.layout.current.settings.seen_games;\n\n\t\t\tif (value) {\n\t\t\t\tseen.push(props.id);\n\t\t\t} else {\n\t\t\t\tconst i = seen.indexOf(props.id);\n\t\t\t\tseen.splice(i, 1);\n\t\t\t}\n\n\t\t\tprops.layout.current.set_settings({\n\t\t\t\t...props.layout.current.settings,\n\t\t\t\tseen_games: seen,\n\t\t\t});\n\n\t\t\t_set_seen(value);\n\t\t}\n\n\t\tvoid (async function () {\n\t\t\tconst api = new GamesAPI(DB_API, abort.signal);\n\n\t\t\ttry {\n\t\t\t\terror_cause.current = 'Unable to fetch game info';\n\t\t\t\tconst data = await api.game(props.id);\n\t\t\t\terror_cause.current = undefined;\n\t\t\t\terror_cause.current = 'Unable to resolve game location';\n\t\t\t\tconst resolved_src = await resolve_game(\n\t\t\t\t\tnew URL(data.src, GAMES_CDN).toString(),\n\t\t\t\t\tdata.type,\n\t\t\t\t\tprops.layout.current.settings.proxy\n\t\t\t\t);\n\t\t\t\terror_cause.current = undefined;\n\t\t\t\tset_data(data);\n\t\t\t\tset_resolved_src(resolved_src);\n\n\t\t\t\tif (!seen) {\n\t\t\t\t\terror_cause.current = 'Unable to update plays';\n\t\t\t\t\tawait api.game_plays(props.id);\n\t\t\t\t\tset_seen(true);\n\t\t\t\t\terror_cause.current = undefined;\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(error);\n\t\t\t\tset_error(error);\n\t\t\t\treturn;\n\t\t\t}\n\t\t})();\n\n\t\treturn () => {\n\t\t\tabort.abort();\n\t\t};\n\t}, [seen, props.id, props.layout]);\n\n\tfunction focus_listener() {\n\t\tif (!iframe.current) {\n\t\t\treturn;\n\t\t}\n\n\t\tiframe.current.contentWindow.focus();\n\n\t\tif (\n\t\t\tdocument.activeElement &&\n\t\t\t!iframe.current.contains(document.activeElement)\n\t\t) {\n\t\t\tdocument.activeElement.blur();\n\t\t\tdocument.activeElement.dispatchEvent(new Event('blur'));\n\t\t}\n\t}\n\n\tuseEffect(() => {\n\t\twindow.addEventListener('focus', focus_listener);\n\n\t\tfocus_listener();\n\n\t\treturn () => {\n\t\t\twindow.removeEventListener('focus', focus_listener);\n\t\t};\n\t}, [data]);\n\n\tif (error) {\n\t\treturn (\n\t\t\t<main className=\"error\">\n\t\t\t\t<p>\n\t\t\t\t\tAn error occurreds when loading the <Obfuscated>game</Obfuscated>:\n\t\t\t\t</p>\n\t\t\t\t<pre>\n\t\t\t\t\t<Obfuscated>{error_cause.current || error.toString()}</Obfuscated>\n\t\t\t\t</pre>\n\t\t\t</main>\n\t\t);\n\t}\n\n\tif (!data) {\n\t\treturn (\n\t\t\t<main>\n\t\t\t\t<span>\n\t\t\t\t\tFetching <Obfuscated>game</Obfuscated> info...\n\t\t\t\t</span>\n\t\t\t</main>\n\t\t);\n\t}\n\n\tconst controls = [];\n\n\tfor (let control of data.controls) {\n\t\tconst visuals = [];\n\n\t\tfor (let key of control.keys) {\n\t\t\tswitch (key) {\n\t\t\t\tcase 'arrows':\n\t\t\t\t\tvisuals.push(\n\t\t\t\t\t\t<div key={key} className=\"move\">\n\t\t\t\t\t\t\t<ArrowDropUp className=\"control-key\" />\n\t\t\t\t\t\t\t<ArrowLeft className=\"control-key\" />\n\t\t\t\t\t\t\t<ArrowDropDown className=\"control-key\" />\n\t\t\t\t\t\t\t<ArrowRight className=\"control-key\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'wasd':\n\t\t\t\t\tvisuals.push(\n\t\t\t\t\t\t<div key={key} className=\"move\">\n\t\t\t\t\t\t\t<div className=\"control-key\">W</div>\n\t\t\t\t\t\t\t<div className=\"control-key\">A</div>\n\t\t\t\t\t\t\t<div className=\"control-key\">S</div>\n\t\t\t\t\t\t\t<div className=\"control-key\">D</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tvisuals.push(\n\t\t\t\t\t\t<div key={key} className={`control-key key-${key}`}>\n\t\t\t\t\t\t\t{key}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tcontrols.push(\n\t\t\t<div key={control.label} className=\"control\">\n\t\t\t\t<div className=\"visuals\">{visuals}</div>\n\t\t\t\t<span className=\"label\">{control.label}</span>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<main\n\t\t\tclassName=\"theatre-player\"\n\t\t\tdata-panorama={Number(panorama)}\n\t\t\tdata-controls={Number(controls_expanded)}\n\t\t>\n\t\t\t<div className=\"frame\">\n\t\t\t\t<iframe\n\t\t\t\t\tref={iframe}\n\t\t\t\t\ttitle=\"Embed\"\n\t\t\t\t\tonLoad={() => {\n\t\t\t\t\t\tiframe.current.contentWindow.addEventListener('keydown', event => {\n\t\t\t\t\t\t\tswitch (event.code) {\n\t\t\t\t\t\t\t\tcase 'Space':\n\t\t\t\t\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\t\t\t\tcase 'ArrowDown':\n\t\t\t\t\t\t\t\tcase 'ArrowLeft':\n\t\t\t\t\t\t\t\tcase 'ArrowRight':\n\t\t\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t// no default\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}}\n\t\t\t\t\tonClick={focus_listener}\n\t\t\t\t\tonFocus={focus_listener}\n\t\t\t\t\tsrc={resolved_src}\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\ttabIndex={0}\n\t\t\t\t\tclassName=\"controls\"\n\t\t\t\t\tref={controls_popup}\n\t\t\t\t\tonBlur={event => {\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t!event.target.contains(event.relatedTarget) &&\n\t\t\t\t\t\t\t!controls_open.current.contains(event.relatedTarget)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tset_controls_expanded(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Close\n\t\t\t\t\t\tclassName=\"close\"\n\t\t\t\t\t\tonClick={() => set_controls_expanded(false)}\n\t\t\t\t\t/>\n\t\t\t\t\t<div className=\"controls\">{controls}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"title\">\n\t\t\t\t<h3 className=\"name\">\n\t\t\t\t\t<Obfuscated>{data.name}</Obfuscated>\n\t\t\t\t</h3>\n\t\t\t\t<div className=\"shift-right\"></div>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"button\"\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tfocus_listener();\n\t\t\t\t\t\tiframe.current.requestFullscreen();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<Fullscreen />\n\t\t\t\t</div>\n\t\t\t\t{controls.length !== 0 && (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"button\"\n\t\t\t\t\t\ttabIndex={0}\n\t\t\t\t\t\tref={controls_open}\n\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\tset_controls_expanded(!controls_expanded);\n\t\t\t\t\t\t\tcontrols_popup.current.focus();\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<VideogameAsset />\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"button\"\n\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\tconst favorites = props.layout.current.settings.favorite_games;\n\t\t\t\t\t\tconst i = favorites.indexOf(props.id);\n\n\t\t\t\t\t\tif (i === -1) {\n\t\t\t\t\t\t\tfavorites.push(props.id);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfavorites.splice(i, 1);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tprops.layout.current.set_settings({\n\t\t\t\t\t\t\t...props.layout.current.settings,\n\t\t\t\t\t\t\tfavorite_games: favorites,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tset_favorited(true);\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{favorited ? <Star /> : <StarBorder />}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"button\"\n\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\tset_panorama(!panorama);\n\n\t\t\t\t\t\tif (!panorama) {\n\t\t\t\t\t\t\tfocus_listener();\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t{panorama ? <ChevronLeft /> : <Panorama />}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</main>\n\t);\n}\n","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z\"\n}), 'ChevronLeft');","import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z\"\n}), 'Fullscreen');"],"names":["GamesAPI","server","signal","this","url","init","fetch","URL","id","outgoing","json","ok","Error","message","error","token","URLSearchParams","method","params","param","sort_params","Item","props","useState","loaded","set_loaded","className","to","resolveRoute","Number","alt","loading","onLoad","src","ellipsis","name","LoadingItem","ItemList","items","attributes","children","item","push","CompatAPI","host","resolve_proxy","setting","api","DB_API","compat","proxy","DEFAULT_PROXY","route","createSvgIcon","_jsx","d","resolve_game","type","rom","core","GAMES_CDN","toString","TypeError","Player","layout","current","settings","favorite_games","includes","favorited","set_favorited","panorama","set_panorama","controls_expanded","set_controls_expanded","set_error","error_cause","useRef","data","set_data","iframe","controls_open","resolved_src","set_resolved_src","controls_popup","seen_games","seen","_set_seen","focus_listener","contentWindow","focus","document","activeElement","contains","blur","dispatchEvent","Event","useEffect","abort","AbortController","set_seen","value","i","indexOf","splice","set_settings","game","undefined","game_plays","console","window","addEventListener","removeEventListener","controls","control","visuals","keys","key","ArrowDropUp","ArrowLeft","ArrowDropDown","ArrowRight","label","ref","title","event","code","preventDefault","onClick","onFocus","tabIndex","onBlur","target","relatedTarget","Close","requestFullscreen","Fullscreen","length","VideogameAsset","favorites","Star","StarBorder","ChevronLeft","Panorama"],"sourceRoot":""}